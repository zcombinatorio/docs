---
title: "Build Deposit Transaction"
description: "POST /damm/deposit/build - Create unsigned transaction for depositing liquidity into Meteora DAMM v2 pool"
---

## Overview

Creates an unsigned transaction for depositing liquidity into a Meteora DAMM v2 (Dynamic AMM) pool. The API validates the deposit amounts, builds a combined transaction that transfers tokens from the manager wallet to the LP owner and adds liquidity to the pool, and returns the transaction ready for manager wallet signing.

<Warning>
**Manager-only operation**: This endpoint requires the manager wallet to sign and submit the transaction.
</Warning>

<CodeGroup>

```bash curl
curl -X POST https://api.zcombinator.io/damm/deposit/build \
  -H "Content-Type: application/json" \
  -d '{
    "tokenAAmount": 1000,
    "tokenBAmount": 0.5
  }'
```

```javascript fetch
const response = await fetch('https://api.zcombinator.io/damm/deposit/build', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    tokenAAmount: 1000,
    tokenBAmount: 0.5
  })
});

const result = await response.json();
```

```python requests
import requests

data = {
    "tokenAAmount": 1000,
    "tokenBAmount": 0.5
}

response = requests.post(
    'https://api.zcombinator.io/damm/deposit/build',
    json=data,
    headers={'Content-Type': 'application/json'}
)

result = response.json()
```

</CodeGroup>

## Request Parameters

<ParamField body="tokenAAmount" type="number" required>
  Amount of Token A to deposit (in UI units, e.g., 1000 for 1000 USDC). Must be non-negative.
</ParamField>

<ParamField body="tokenBAmount" type="number" required>
  Amount of Token B to deposit (in UI units, e.g., 0.5 for 0.5 SOL). Must be non-negative.
</ParamField>

<Note>
**UI units**: Amounts are specified in human-readable units (e.g., 1.5 SOL, not 1500000000 lamports). The API automatically converts to raw token amounts based on token decimals.
</Note>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the operation was successful
</ResponseField>

<ResponseField name="transaction" type="string">
  Base58 encoded unsigned transaction that needs to be signed by the manager wallet
</ResponseField>

<ResponseField name="requestId" type="string">
  Unique identifier for this deposit request (needed for confirmation)
</ResponseField>

<ResponseField name="poolAddress" type="string">
  Address of the Meteora DAMM v2 pool
</ResponseField>

<ResponseField name="tokenAMint" type="string">
  Mint address of Token A in the pool
</ResponseField>

<ResponseField name="tokenBMint" type="string">
  Mint address of Token B in the pool
</ResponseField>

<ResponseField name="isTokenBNativeSOL" type="boolean">
  Whether Token B is native SOL
</ResponseField>

<ResponseField name="amounts" type="object">
  Object containing deposit amounts in raw token units
</ResponseField>

<ResponseField name="message" type="string">
  Instructions for the next step
</ResponseField>

### Success Response

```json
{
  "success": true,
  "transaction": "4MzR7dxJNJRVP1Q6k7Y3j8X...",
  "requestId": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",
  "poolAddress": "CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C",
  "tokenAMint": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
  "tokenBMint": "So11111111111111111111111111111111111111112",
  "isTokenBNativeSOL": true,
  "instructionsCount": 9,
  "amounts": {
    "tokenA": "1000000000",
    "tokenB": "500000000",
    "liquidityDelta": "707106781"
  },
  "message": "Sign this transaction with the manager wallet and submit to /damm/deposit/confirm"
}
```

## Error Responses

<AccordionGroup>
  <Accordion title="400 - Missing Parameters">
    ```json
    {
      "error": "Missing required fields: tokenAAmount and tokenBAmount"
    }
    ```
  </Accordion>

  <Accordion title="400 - Invalid Amount Type">
    ```json
    {
      "error": "tokenAAmount and tokenBAmount must be numbers"
    }
    ```
  </Accordion>

  <Accordion title="400 - Negative Amounts">
    ```json
    {
      "error": "Token amounts must be non-negative"
    }
    ```
  </Accordion>

  <Accordion title="404 - No Positions Found">
    ```json
    {
      "error": "No positions found for the LP owner. Create a position first."
    }
    ```
  </Accordion>

  <Accordion title="400 - Deposit Too Small">
    ```json
    {
      "error": "Deposit amount too small"
    }
    ```
  </Accordion>
</AccordionGroup>

## Process Flow

<Steps>
<Step title="Validate Parameters">
Ensures amounts are provided, valid numbers, and non-negative
</Step>

<Step title="Fetch Pool State">
Retrieves the current state of the Meteora DAMM v2 pool
</Step>

<Step title="Convert to Raw Amounts">
Converts UI amounts to raw token amounts based on decimals
</Step>

<Step title="Get User Positions">
Fetches LP positions owned by the protocol wallet
</Step>

<Step title="Calculate Liquidity Amount">
Calculates liquidity based on token amounts and pool state
</Step>

<Step title="Build Transaction">
Creates a transaction that transfers tokens and adds liquidity
</Step>

<Step title="Generate Security Hash">
Creates a security hash for tamper detection
</Step>

<Step title="Return Unsigned Transaction">
Returns the Base58 encoded transaction for signing
</Step>
</Steps>

## Native SOL Handling

<Info>
**Special handling for wrapped SOL (wSOL)**:

When Token B is the native SOL mint:
1. The manager wallet transfers native SOL to the LP owner
2. Meteora automatically wraps SOL during the add liquidity operation
3. No intermediate token account is needed for Token B
</Info>

## Rate Limiting

This endpoint is subject to rate limiting:
- **10 requests** per 5-minute window per IP
- Returns HTTP 429 when limit exceeded

## Security Considerations

<Warning>
**Manager authorization required**:
- Only the configured manager wallet can sign and confirm deposits
- Tokens are transferred from manager wallet to LP owner, then added to pool
- Transaction hash validation prevents tampering during confirmation
</Warning>

## Next Steps

After receiving the unsigned transaction:

1. **Deserialize** the transaction using `@solana/web3.js`
2. **Sign** the transaction with your manager wallet
3. **Submit** the signed transaction to [Confirm Deposit](/api-reference/damm-liquidity/deposit-confirm)

<Warning>
Do not modify the transaction after signing. The confirmation endpoint validates the transaction hash to detect any tampering.
</Warning>
