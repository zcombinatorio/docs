---
title: "Confirm Deposit Transaction"
description: "POST /damm/deposit/confirm - Submit signed deposit transaction to the blockchain"
---

## Overview

Confirms and submits a signed liquidity deposit transaction to the Solana blockchain. This endpoint validates the transaction structure comprehensively, verifies the transaction hasn't been tampered with, and broadcasts it to the network.

<Warning>
**Enhanced security**: This endpoint validates that the transaction hasn't been modified after creation, preventing tampering attacks.
</Warning>

<CodeGroup>

```bash curl
curl -X POST https://api.zcombinator.io/damm/deposit/confirm \
  -H "Content-Type: application/json" \
  -d '{
    "signedTransaction": "4MzR7dxJNJRVP1Q6k7Y3j8X...",
    "requestId": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
  }'
```

```javascript fetch
const response = await fetch('https://api.zcombinator.io/damm/deposit/confirm', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    signedTransaction: "4MzR7dxJNJRVP1Q6k7Y3j8X...",
    requestId: "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
  })
});

const result = await response.json();
```

```python requests
import requests

data = {
    "signedTransaction": "4MzR7dxJNJRVP1Q6k7Y3j8X...",
    "requestId": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
}

response = requests.post(
    'https://api.zcombinator.io/damm/deposit/confirm',
    json=data,
    headers={'Content-Type': 'application/json'}
)

result = response.json()
```

</CodeGroup>

## Request Parameters

<ParamField body="signedTransaction" type="string" required>
  Base58 encoded signed transaction from the manager wallet
</ParamField>

<ParamField body="requestId" type="string" required>
  Unique identifier returned from the `/damm/deposit/build` endpoint
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the transaction was submitted successfully
</ResponseField>

<ResponseField name="signature" type="string">
  Transaction signature (transaction ID) on Solana
</ResponseField>

<ResponseField name="poolAddress" type="string">
  Address of the Meteora DAMM v2 pool
</ResponseField>

<ResponseField name="tokenAMint" type="string">
  Mint address of Token A in the pool
</ResponseField>

<ResponseField name="tokenBMint" type="string">
  Mint address of Token B in the pool
</ResponseField>

<ResponseField name="amounts" type="object">
  Object containing the deposited amounts in raw token units
</ResponseField>

<ResponseField name="message" type="string">
  Success message
</ResponseField>

### Success Response

```json
{
  "success": true,
  "signature": "5J8Z9xKqH4nL2pR7vT3mB1cW6dF8yG4aS9jK2xM5nP8hQ3rV7wE1",
  "poolAddress": "CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C",
  "tokenAMint": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
  "tokenBMint": "So11111111111111111111111111111111111111112",
  "amounts": {
    "tokenA": "1000000000",
    "tokenB": "500000000",
    "liquidityDelta": "707106781"
  },
  "message": "Deposit transaction submitted successfully"
}
```

## Error Responses

<AccordionGroup>
  <Accordion title="400 - Missing Parameters">
    ```json
    {
      "error": "Missing required fields: signedTransaction and requestId"
    }
    ```
  </Accordion>

  <Accordion title="400 - Request Not Found">
    ```json
    {
      "error": "Deposit request not found or expired. Please call /damm/deposit/build first."
    }
    ```
  </Accordion>

  <Accordion title="400 - Request Expired">
    ```json
    {
      "error": "Deposit request expired. Please create a new request."
    }
    ```
  </Accordion>

  <Accordion title="400 - Transaction Tampered">
    ```json
    {
      "error": "Transaction verification failed: transaction has been modified"
    }
    ```
  </Accordion>

  <Accordion title="400 - Fee Payer Mismatch">
    ```json
    {
      "error": "Transaction fee payer must be manager wallet"
    }
    ```
  </Accordion>

  <Accordion title="400 - Invalid Manager Signature">
    ```json
    {
      "error": "Transaction verification failed: Invalid manager wallet signature"
    }
    ```
  </Accordion>

  <Accordion title="400 - Unauthorized LP Owner Transfer">
    ```json
    {
      "error": "Invalid transaction: LP owner transfers must go to pool vaults only"
    }
    ```
  </Accordion>
</AccordionGroup>

## Process Flow

<Steps>
<Step title="Validate Parameters">
Ensures signedTransaction and requestId are provided
</Step>

<Step title="Retrieve Request Data">
Looks up the deposit request data using the requestId
</Step>

<Step title="Queue Request">
Ensures only one operation processes at a time for this pool
</Step>

<Step title="Validate Blockhash">
Checks that the blockhash is recent (within last 150 slots)
</Step>

<Step title="Verify Manager Wallet">
Ensures the fee payer is the manager wallet and has signed
</Step>

<Step title="Verify Transaction Integrity">
Calculates SHA-256 hash to detect tampering
</Step>

<Step title="Validate Transaction Structure">
Comprehensive security validation of all instructions
</Step>

<Step title="Submit Transaction">
Broadcasts the fully-signed transaction to Solana
</Step>

<Step title="Cleanup">
Removes the request data and releases the pool lock
</Step>
</Steps>

## Security Validations

<AccordionGroup>
  <Accordion title="Tampering Detection">
    Cryptographic validation detects any modification to the transaction structure.
  </Accordion>

  <Accordion title="Manager Wallet Verification">
    Only the configured manager wallet can submit deposit transactions. Both fee payer and signature are verified.
  </Accordion>

  <Accordion title="Allowed Programs">
    Only permits instructions from Token Program, Associated Token Program, Compute Budget, Lighthouse, Meteora CP-AMM, Meteora DAMM v2, and System Program.
  </Accordion>

  <Accordion title="Destination Validation - Manager">
    Manager wallet transfers can ONLY go to LP owner's token accounts.
  </Accordion>

  <Accordion title="Destination Validation - LP Owner">
    **CRITICAL**: LP owner transfers can ONLY go to pool vaults. This prevents fund drainage attacks.
  </Accordion>

  <Accordion title="Amount Validation">
    Transfer amounts cannot exceed specified deposit amounts.
  </Accordion>
</AccordionGroup>

## Rate Limiting

This endpoint is subject to rate limiting:
- **10 requests** per 5-minute window per IP
- Returns HTTP 429 when limit exceeded

## Concurrent Request Handling

<Warning>
**Request queueing**: Only one liquidity operation can be processed per pool at a time. Concurrent requests are automatically queued.
</Warning>

## Fund Flow

Understanding the fund flow during deposit:

<Steps>
<Step title="Manager → LP Owner">
Manager wallet transfers tokens to LP owner's token accounts
</Step>

<Step title="LP Owner → Pool Vaults">
LP owner's tokens are transferred to the pool
</Step>

<Step title="LP Tokens Minted">
LP position NFT is updated with increased liquidity
</Step>
</Steps>

## Best Practices

<Steps>
<Step title="Check Blockhash Age">
Submit quickly after receiving from `/damm/deposit/build`. Blockhashes expire after ~60 seconds.
</Step>

<Step title="Do Not Modify Transaction">
Any modification will be detected and rejected.
</Step>

<Step title="Verify Balances">
Ensure your manager wallet has sufficient token balances.
</Step>
</Steps>

You can view the transaction on Solscan: `https://solscan.io/tx/{signature}`
