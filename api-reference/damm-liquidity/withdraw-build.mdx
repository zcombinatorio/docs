---
title: "Build Withdrawal Transaction"
description: "POST /damm/withdraw/build - Create unsigned transaction for withdrawing liquidity from Meteora DAMM v2 pool"
---

## Overview

Creates an unsigned transaction for withdrawing liquidity from a Meteora DAMM v2 (Dynamic AMM) pool. The API validates available liquidity, builds a combined transaction that removes liquidity and transfers withdrawn tokens to the manager wallet, and returns the transaction ready for manager wallet signing.

<Warning>
**Manager-only operation**: This endpoint requires the manager wallet to sign and submit the transaction.
</Warning>

<CodeGroup>

```bash curl
curl -X POST https://api.zcombinator.io/damm/withdraw/build \
  -H "Content-Type: application/json" \
  -d '{
    "withdrawalPercentage": 12.5
  }'
```

```javascript fetch
const response = await fetch('https://api.zcombinator.io/damm/withdraw/build', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    withdrawalPercentage: 12.5
  })
});

const result = await response.json();
```

```python requests
import requests

data = {
    "withdrawalPercentage": 12.5
}

response = requests.post(
    'https://api.zcombinator.io/damm/withdraw/build',
    json=data,
    headers={'Content-Type': 'application/json'}
)

result = response.json()
```

</CodeGroup>

## Request Parameters

<ParamField body="withdrawalPercentage" type="number" required>
  Percentage of unlocked liquidity to withdraw (`0 < value <= 50`). For example, `12.5` withdraws 12.5% of available liquidity.
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the operation was successful
</ResponseField>

<ResponseField name="transaction" type="string">
  Base58 encoded unsigned transaction that needs to be signed by the manager wallet
</ResponseField>

<ResponseField name="requestId" type="string">
  Unique identifier for this withdrawal request (needed for confirmation)
</ResponseField>

<ResponseField name="poolAddress" type="string">
  Address of the Meteora DAMM v2 pool
</ResponseField>

<ResponseField name="tokenAMint" type="string">
  Mint address of Token A in the pool
</ResponseField>

<ResponseField name="tokenBMint" type="string">
  Mint address of Token B in the pool
</ResponseField>

<ResponseField name="isTokenBNativeSOL" type="boolean">
  Whether Token B is native SOL
</ResponseField>

<ResponseField name="withdrawalPercentage" type="number">
  The withdrawal percentage requested
</ResponseField>

<ResponseField name="estimatedAmounts" type="object">
  Object containing estimated withdrawal amounts
</ResponseField>

<ResponseField name="message" type="string">
  Instructions for the next step
</ResponseField>

### Success Response

```json
{
  "success": true,
  "transaction": "4MzR7dxJNJRVP1Q6k7Y3j8X...",
  "requestId": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",
  "poolAddress": "CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C",
  "tokenAMint": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
  "tokenBMint": "So11111111111111111111111111111111111111112",
  "isTokenBNativeSOL": true,
  "withdrawalPercentage": 12.5,
  "instructionsCount": 7,
  "estimatedAmounts": {
    "tokenA": "5000000",
    "tokenB": "2500000000",
    "liquidityDelta": "1000000"
  },
  "message": "Sign this transaction with the manager wallet and submit to /damm/withdraw/confirm"
}
```

## Error Responses

<AccordionGroup>
  <Accordion title="400 - Missing Parameters">
    ```json
    {
      "error": "Missing required field: withdrawalPercentage"
    }
    ```
  </Accordion>

  <Accordion title="400 - Invalid Withdrawal Percentage">
    ```json
    {
      "error": "withdrawalPercentage must be a number between 0 and 50"
    }
    ```

    The withdrawal percentage must be greater than 0 and not exceed 50.
  </Accordion>

  <Accordion title="404 - No Positions Found">
    ```json
    {
      "error": "No positions found for the LP owner in this pool"
    }
    ```
  </Accordion>

  <Accordion title="400 - No Unlocked Liquidity">
    ```json
    {
      "error": "No unlocked liquidity in position"
    }
    ```
  </Accordion>

  <Accordion title="400 - Withdrawal Too Small">
    ```json
    {
      "error": "Withdrawal amount too small"
    }
    ```
  </Accordion>
</AccordionGroup>

## Process Flow

<Steps>
<Step title="Validate Parameters">
Ensures withdrawalPercentage is between 0 and 50
</Step>

<Step title="Fetch Pool State">
Retrieves the current state of the Meteora DAMM v2 pool
</Step>

<Step title="Get User Positions">
Fetches LP positions owned by the protocol wallet
</Step>

<Step title="Calculate Withdrawal Amount">
Calculates liquidityDelta based on percentage and available liquidity
</Step>

<Step title="Calculate Token Amounts">
Calculates exact token amounts based on current pool state
</Step>

<Step title="Build Transaction">
Creates a transaction that removes liquidity and transfers tokens
</Step>

<Step title="Return Unsigned Transaction">
Returns the Base58 encoded transaction for signing
</Step>
</Steps>

## Withdrawal Percentage Calculation

The withdrawal amount is calculated as:

```
liquidityDelta = unlockedLiquidity * (withdrawalPercentage * 1000) / 100000
```

<Note>
**First position only**: This endpoint withdraws from the first position. If multiple positions exist, call this endpoint multiple times.
</Note>

## Native SOL Handling

<Info>
**Special handling for wrapped SOL (wSOL)**:

When Token B is the native SOL mint:
1. Meteora automatically unwraps wSOL to native SOL during withdrawal
2. No token account is created for Token B for the LP owner
3. Transfers use `SystemProgram.transfer` instead of SPL token transfer
4. Withdrawn SOL is received directly as native SOL
</Info>

## Rate Limiting

This endpoint is subject to rate limiting:
- **10 requests** per 5-minute window per IP
- Returns HTTP 429 when limit exceeded

## Security Considerations

<Warning>
**Manager authorization required**:
- Only the configured manager wallet can sign and confirm withdrawals
- Withdrawn tokens always go to the manager wallet
- This prevents unauthorized liquidity withdrawals
</Warning>

## Next Steps

After receiving the unsigned transaction:

1. **Deserialize** the transaction using `@solana/web3.js`
2. **Sign** the transaction with your manager wallet
3. **Submit** the signed transaction to [Confirm Withdrawal](/api-reference/damm-liquidity/withdraw-confirm)
