---
title: "Confirm Withdrawal Transaction"
description: "POST /damm/withdraw/confirm - Submit signed withdrawal transaction to the blockchain"
---

## Overview

Confirms and submits a signed liquidity withdrawal transaction to the Solana blockchain. This endpoint validates the transaction structure comprehensively and broadcasts it to the network. The transaction removes liquidity from a Meteora DAMM v2 pool and transfers all withdrawn tokens to the manager wallet.

<Warning>
**Concurrent request handling**: Only one withdrawal operation can be processed at a time for each pool. Additional requests will wait in queue.
</Warning>

<CodeGroup>

```bash curl
curl -X POST https://api.zcombinator.io/damm/withdraw/confirm \
  -H "Content-Type: application/json" \
  -d '{
    "signedTransaction": "4MzR7dxJNJRVP1Q6k7Y3j8X...",
    "requestId": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
  }'
```

```javascript fetch
const response = await fetch('https://api.zcombinator.io/damm/withdraw/confirm', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    signedTransaction: "4MzR7dxJNJRVP1Q6k7Y3j8X...",
    requestId: "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
  })
});

const result = await response.json();
```

```python requests
import requests

data = {
    "signedTransaction": "4MzR7dxJNJRVP1Q6k7Y3j8X...",
    "requestId": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
}

response = requests.post(
    'https://api.zcombinator.io/damm/withdraw/confirm',
    json=data,
    headers={'Content-Type': 'application/json'}
)

result = response.json()
```

</CodeGroup>

## Request Parameters

<ParamField body="signedTransaction" type="string" required>
  Base58 encoded signed transaction from the manager wallet
</ParamField>

<ParamField body="requestId" type="string" required>
  Unique identifier returned from the `/damm/withdraw/build` endpoint
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the transaction was submitted successfully
</ResponseField>

<ResponseField name="signature" type="string">
  Transaction signature (transaction ID) on Solana
</ResponseField>

<ResponseField name="poolAddress" type="string">
  Address of the Meteora DAMM v2 pool
</ResponseField>

<ResponseField name="tokenAMint" type="string">
  Mint address of Token A in the pool
</ResponseField>

<ResponseField name="tokenBMint" type="string">
  Mint address of Token B in the pool
</ResponseField>

<ResponseField name="withdrawalPercentage" type="number">
  Percentage of liquidity that was withdrawn
</ResponseField>

<ResponseField name="estimatedAmounts" type="object">
  Object containing the withdrawn amounts
</ResponseField>

<ResponseField name="message" type="string">
  Success message
</ResponseField>

### Success Response

```json
{
  "success": true,
  "signature": "5J8Z9xKqH4nL2pR7vT3mB1cW6dF8yG4aS9jK2xM5nP8hQ3rV7wE1",
  "poolAddress": "CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C",
  "tokenAMint": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
  "tokenBMint": "So11111111111111111111111111111111111111112",
  "withdrawalPercentage": 50,
  "estimatedAmounts": {
    "tokenA": "5000000",
    "tokenB": "2500000000",
    "liquidityDelta": "1000000"
  },
  "message": "Withdrawal transaction submitted successfully"
}
```

## Error Responses

<AccordionGroup>
  <Accordion title="400 - Missing Parameters">
    ```json
    {
      "error": "Missing required fields: signedTransaction and requestId"
    }
    ```
  </Accordion>

  <Accordion title="400 - Request Not Found">
    ```json
    {
      "error": "Withdrawal request not found or expired. Please call /damm/withdraw/build first."
    }
    ```
  </Accordion>

  <Accordion title="400 - Request Expired">
    ```json
    {
      "error": "Withdrawal request expired. Please create a new request."
    }
    ```
  </Accordion>

  <Accordion title="400 - Fee Payer Mismatch">
    ```json
    {
      "error": "Transaction fee payer must be manager wallet"
    }
    ```
  </Accordion>

  <Accordion title="400 - Invalid Manager Signature">
    ```json
    {
      "error": "Transaction verification failed: Invalid manager wallet signature"
    }
    ```
  </Accordion>

  <Accordion title="400 - Unauthorized Destination">
    ```json
    {
      "error": "Invalid transaction: transfer destination not authorized"
    }
    ```
  </Accordion>

  <Accordion title="400 - Invalid System Transfer">
    ```json
    {
      "error": "Invalid transaction: system transfer destination must be manager wallet"
    }
    ```
  </Accordion>
</AccordionGroup>

## Process Flow

<Steps>
<Step title="Validate Parameters">
Ensures signedTransaction and requestId are provided
</Step>

<Step title="Retrieve Request Data">
Looks up the withdrawal request data using the requestId
</Step>

<Step title="Queue Request">
Ensures only one operation processes at a time for this pool
</Step>

<Step title="Validate Blockhash">
Checks that the blockhash is recent (within last 150 slots)
</Step>

<Step title="Verify Manager Wallet">
Ensures the fee payer is the manager wallet and has signed
</Step>

<Step title="Validate Transaction Structure">
Comprehensive security validation of all instructions
</Step>

<Step title="Submit Transaction">
Broadcasts the fully-signed transaction to Solana
</Step>

<Step title="Cleanup">
Removes the request data and releases the pool lock
</Step>
</Steps>

## Security Validations

<AccordionGroup>
  <Accordion title="Request Queueing">
    Only one liquidity operation can be processed per pool at a time. Concurrent requests are automatically queued.
  </Accordion>

  <Accordion title="Blockhash Validation">
    Prevents replay attacks by verifying the blockhash is recent (~60 seconds).
  </Accordion>

  <Accordion title="Manager Wallet Verification">
    Only the configured manager wallet can submit withdrawal transactions.
  </Accordion>

  <Accordion title="Allowed Programs">
    Only permits instructions from Token Program, Associated Token Program, Compute Budget, Lighthouse, Meteora CP-AMM, Meteora DAMM v2, and System Program.
  </Accordion>

  <Accordion title="Destination Validation">
    Transfers can ONLY go to manager wallet token accounts or LP owner token accounts.
  </Accordion>

  <Accordion title="Amount Validation">
    Transfer amounts cannot exceed calculated withdrawal amounts.
  </Accordion>
</AccordionGroup>

<Warning>
**Manager authorization required**: Unlike fee claims, withdrawals require manager wallet authorization. Only the configured manager wallet can execute withdrawals.
</Warning>

## Rate Limiting

This endpoint is subject to rate limiting:
- **10 requests** per 5-minute window per IP
- Returns HTTP 429 when limit exceeded

## Transaction Confirmation

You can view the transaction on Solscan: `https://solscan.io/tx/{signature}`

## Best Practices

<Steps>
<Step title="Check Blockhash Age">
Submit quickly after receiving from `/damm/withdraw/build`. Blockhashes expire after ~60 seconds.
</Step>

<Step title="Handle Expiry">
If more than 10 minutes pass, create a new withdrawal request.
</Step>

<Step title="Handle Queueing">
If you receive a timeout, another request may be processing. Wait and retry.
</Step>

<Step title="Manage Withdrawals Carefully">
Withdrawals remove liquidity from the pool. Ensure you're withdrawing the correct percentage.
</Step>
</Steps>
