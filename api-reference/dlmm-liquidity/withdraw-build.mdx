---
title: "Build Withdrawal Transaction"
description: "POST /dlmm/withdraw/build - Create unsigned transactions for withdrawing liquidity from Meteora DLMM pool"
---

## Overview

Creates unsigned transactions for withdrawing liquidity from a Meteora DLMM (Dynamic Liquidity Market Maker) pool. The API fetches the current market price from Jupiter, calculates the optimal token ratio, and builds transactions that:

1. Remove liquidity from DLMM bins
2. Redeposit excess tokens back to the DLMM (to match market price ratio)
3. Transfer correctly-ratioed amounts to the manager wallet

This ensures the withdrawn tokens match the true market price, not the potentially skewed DLMM bin distribution.

<Warning>
**Manager-only operation**: This endpoint requires the manager wallet to sign and submit the transactions.
</Warning>

<CodeGroup>

```bash curl
curl -X POST https://api.zcombinator.io/dlmm/withdraw/build \
  -H "Content-Type: application/json" \
  -d '{
    "poolAddress": "7jbhVZcYqCRmciBcZzK8L5B96Pyw7i1SpXQFKBkzD3G2",
    "withdrawalPercentage": 12
  }'
```

```javascript fetch
const response = await fetch('https://api.zcombinator.io/dlmm/withdraw/build', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    poolAddress: "7jbhVZcYqCRmciBcZzK8L5B96Pyw7i1SpXQFKBkzD3G2",
    withdrawalPercentage: 12
  })
});

const result = await response.json();
```

```python requests
import requests

data = {
    "poolAddress": "7jbhVZcYqCRmciBcZzK8L5B96Pyw7i1SpXQFKBkzD3G2",
    "withdrawalPercentage": 12
}

response = requests.post(
    'https://api.zcombinator.io/dlmm/withdraw/build',
    json=data,
    headers={'Content-Type': 'application/json'}
)

result = response.json()
```

</CodeGroup>

## Request Parameters

<ParamField body="poolAddress" type="string" required>
  Address of the Meteora DLMM pool. Must be a whitelisted pool.
</ParamField>

<ParamField body="withdrawalPercentage" type="number" required>
  Percentage of liquidity to withdraw (`0 < value <= 50`). For example, `12` withdraws 12% of available liquidity from each bin.
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the operation was successful
</ResponseField>

<ResponseField name="transactions" type="string[]">
  Array of Base58 encoded unsigned transactions that need to be signed by the manager wallet
</ResponseField>

<ResponseField name="transactionCount" type="number">
  Number of transactions in the array
</ResponseField>

<ResponseField name="requestId" type="string">
  Unique identifier for this withdrawal request (needed for confirmation)
</ResponseField>

<ResponseField name="poolAddress" type="string">
  Address of the Meteora DLMM pool
</ResponseField>

<ResponseField name="tokenXMint" type="string">
  Mint address of Token X (base token) in the pool
</ResponseField>

<ResponseField name="tokenYMint" type="string">
  Mint address of Token Y (quote token) in the pool
</ResponseField>

<ResponseField name="tokenXDecimals" type="number">
  Decimal places for Token X
</ResponseField>

<ResponseField name="tokenYDecimals" type="number">
  Decimal places for Token Y
</ResponseField>

<ResponseField name="marketPrice" type="number">
  Current market price from Jupiter (Token Y per Token X, e.g., SOL per ZC)
</ResponseField>

<ResponseField name="withdrawn" type="object">
  Total amounts withdrawn from DLMM bins (before price adjustment)
  - `tokenX`: Base token amount (raw)
  - `tokenY`: Quote token amount (raw)
</ResponseField>

<ResponseField name="transferred" type="object">
  Amounts transferred to manager wallet (at market price ratio)
  - `tokenX`: Base token amount (raw)
  - `tokenY`: Quote token amount (raw)
</ResponseField>

<ResponseField name="redeposited" type="object">
  Excess amounts redeposited back to DLMM
  - `tokenX`: Base token amount (raw)
  - `tokenY`: Quote token amount (raw)
</ResponseField>

<ResponseField name="message" type="string">
  Instructions for the next step
</ResponseField>

### Success Response

```json
{
  "success": true,
  "transactions": ["4MzR7dxJNJRVP1Q6k7Y3j8X...", "5KnS8exLMJSVQ2..."],
  "transactionCount": 2,
  "requestId": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",
  "poolAddress": "7jbhVZcYqCRmciBcZzK8L5B96Pyw7i1SpXQFKBkzD3G2",
  "tokenXMint": "zcraWGxqe41N9xPaThNAB8Xf6sxjEvnAhpKKEZ3xyqC",
  "tokenYMint": "So11111111111111111111111111111111111111112",
  "tokenXDecimals": 6,
  "tokenYDecimals": 9,
  "lpOwnerAddress": "LP1abc...",
  "destinationAddress": "MGR1xyz...",
  "withdrawalPercentage": 12,
  "marketPrice": 0.0000040643,
  "withdrawn": {
    "tokenX": "8784740187834",
    "tokenY": "40288634947"
  },
  "transferred": {
    "tokenX": "8784740187834",
    "tokenY": "35700000000"
  },
  "redeposited": {
    "tokenX": "0",
    "tokenY": "4588634947"
  },
  "message": "Sign all transactions with the manager wallet and submit to /dlmm/withdraw/confirm"
}
```

## Error Responses

<AccordionGroup>
  <Accordion title="400 - Missing Parameters">
    ```json
    {
      "error": "Missing required field: poolAddress"
    }
    ```
  </Accordion>

  <Accordion title="400 - Invalid Pool Address">
    ```json
    {
      "error": "Invalid poolAddress: must be a valid Solana public key"
    }
    ```
  </Accordion>

  <Accordion title="403 - Pool Not Whitelisted">
    ```json
    {
      "error": "Pool not authorized for liquidity operations"
    }
    ```
  </Accordion>

  <Accordion title="400 - Invalid Withdrawal Percentage">
    ```json
    {
      "error": "withdrawalPercentage must be a number between 0 and 50"
    }
    ```
  </Accordion>

  <Accordion title="404 - No Positions Found">
    ```json
    {
      "error": "No positions found for the LP owner in this pool"
    }
    ```
  </Accordion>

  <Accordion title="400 - No Liquidity">
    ```json
    {
      "error": "No liquidity in position"
    }
    ```
  </Accordion>

  <Accordion title="500 - Jupiter Price Error">
    ```json
    {
      "error": "Jupiter API: No price data for token X (mint_address)"
    }
    ```
  </Accordion>
</AccordionGroup>

## Process Flow

<Steps>
<Step title="Validate Parameters">
Ensures poolAddress is whitelisted and withdrawalPercentage is between 0 and 50
</Step>

<Step title="Fetch Pool State">
Retrieves the current state of the Meteora DLMM pool and LP positions
</Step>

<Step title="Build Remove Liquidity Transactions">
Creates transactions to remove the specified percentage from all bins
</Step>

<Step title="Fetch Jupiter Market Price">
Calls Jupiter Price API to get the true market price of the token pair
</Step>

<Step title="Calculate Optimal Amounts">
Determines which token is in excess and calculates amounts at market price ratio
</Step>

<Step title="Build Redeposit Transaction">
If there's excess, creates a transaction to add it back to the DLMM
</Step>

<Step title="Build Transfer Transaction">
Creates a transaction to transfer correctly-ratioed amounts to manager
</Step>

<Step title="Return Unsigned Transactions">
Returns all transactions as Base58 encoded strings for signing
</Step>
</Steps>

## Price Adjustment Logic

The DLMM bin distribution may not match the current market price. To ensure the withdrawn tokens are at the correct ratio:

```
1. Withdraw from DLMM bins → get withdrawnX, withdrawnY
2. Fetch Jupiter price → get marketPrice (tokenY per tokenX)
3. Calculate needed amounts at market price:
   - If excess tokenY: use all tokenX, calculate neededY = tokenX * marketPrice
   - If excess tokenX: use all tokenY, calculate neededX = tokenY / marketPrice
4. Redeposit excess back to DLMM
5. Transfer only the correctly-ratioed amounts to manager
```

<Info>
**Example**: If you withdraw 8.7M ZC and 40.3 SOL, but the Jupiter price implies you should have 35.7 SOL for 8.7M ZC, then 4.6 SOL is redeposited back to the DLMM and only 35.7 SOL is transferred to the manager.
</Info>

## Native SOL Handling

<Info>
**Special handling for wrapped SOL (wSOL)**:

When Token Y is the native SOL mint:
1. Withdrawal unwraps wSOL to native SOL
2. If redepositing excess SOL, it's automatically wrapped back to wSOL
3. Transfer to manager uses `SystemProgram.transfer` for native SOL
</Info>

## Rate Limiting

This endpoint is subject to rate limiting:
- **10 requests** per 5-minute window per IP
- Returns HTTP 429 when limit exceeded

## Security Considerations

<Warning>
**Manager authorization required**:
- Only the configured manager wallet can sign and confirm withdrawals
- Withdrawn tokens always go to the manager wallet
- Pool must be whitelisted for operations
</Warning>

## Next Steps

After receiving the unsigned transactions:

1. **Sign all transactions** with your manager wallet using `@solana/web3.js`
2. **Submit** the signed transactions array to [Confirm Withdrawal](/api-reference/dlmm-liquidity/withdraw-confirm)

```javascript
// Example: Sign all transactions
const signedTxs = transactions.map(txBase58 => {
  const tx = Transaction.from(bs58.decode(txBase58));
  tx.sign(managerKeypair);
  return bs58.encode(tx.serialize({ requireAllSignatures: false }));
});
```
